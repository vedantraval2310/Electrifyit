<!DOCTYPE html>
<html lang="en">
  <head>
    
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=100%" />
    
    <link
    rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"
  />

  <link
  rel="stylesheet"
  href="https://fonts.googleapis.com/icon?family=Material+Icons"
/>

    <link rel="stylesheet" href="CSS/general.css" />
    <link rel="stylesheet" href="CSS/style.css" />
    <link rel="stylesheet" href="CSS/table.css" />
    <link rel="stylesheet" href="CSS/chord.css" />

    <title>Dashboard</title>

  </head>

  <body>

    <!-- Header -->
    <header class="header">

      <!-- LOGO -->
      <a href="index.html">
        
        <img class="logo" alt="Electrofyit Logo" src="IMG/electrifyit_logo.jpeg" />
      
      </a>

      <!-- NAV_BAR CONTENTS-->
      <nav class="main-nav">
        
        <ul class="main-nav-list">
    
          <li>
            
            <a class="main-nav-link nav-signin" href="director.html"
              >Back</a
            >
          </li>

          <li>
            
            <a class="main-nav-link nav-signin" href="index.html"
              >Logout</a
            >
          </li>

        </ul>
      
      </nav>

    </header>

    <!-- PROFILE BAR -->
    <main>
      
      <div class="boxed-faculty">
        
        <section class="profile">
          
          <div class="container grid grid-cols-2 grid-profile">
            
            <div class="img-box">
              <img
                src="IMG/user-img.png"
                class="f-img"
                alt="passport size faculty image"
              />
            </div>

            <div class="text-box">
              
              <h2 id="faculty_name" class="secondary-heading f-name">
                John Smith
              </h2>
              
              <p class="f-email">
                <a
                  id="email_id"
                  class="email-link"
                  href="mailto:hello@example.com"
                  >emailid</a
                >
              </p>

            </div>
          
          </div>
        
        </section>
      
      </div>

    </main>
          <button
            class="heading-name"
            onClick="opentab(event,'content-publication')"
          >Average Miles per EV Maker <span class="material-icons">&#xE873;</span>
          </button>

          <button
            class="heading-name"
            onClick="opentab(event,'content-co-author')"
          >
            Average Miles per EV type <span class="material-icons">&#xE873;</span>
          </button>
          
          <!-- WORDCLOUD -->

          <button
            class="heading-name"
            onClick="opentab(event,'content-wordcloud')"
          >
            Average Miles per EV Maker and Types <span class="material-icons">&#xE873;</span>
          </button>

        </div>

      </div>
      
      <!-- PUBLICATION CONTENT-->

      <div id="content-publication" class="tabcontent">
        <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
        <h2>Global Average Miles driven 2023-2024</h2>
        <canvas id="Averagemilesdriven" width="200" height="50"></canvas>
        <script>
      window.addEventListener('load', setup);

      async function setup() {
        const ctx = document.getElementById('Averagemilesdriven').getContext('2d');
        const Averagemiles = await getsimpleData();
        const myChart = new Chart(ctx, {
          type: 'line',
          data: {
            labels: Averagemiles.makes,
            datasets: [
              {
                label: 'Miles driven in Miles',
                data: Averagemiles.averageMiles,
                fill: false,
                borderColor: 'rgba(255, 99, 132, 1)',
                backgroundColor: 'rgba(255, 99, 132, 0.5)',
                borderWidth: 1
              }
            ]
          },
          options: {}
        });
      }

      async function getsimpleData() {

        const api = await fetch(`/api/V1/all`);
        const api_data = await api.json();
        const array_data = api_data.result;
        const makeStats = {};
        array_data.forEach(ev => {
          if (!makeStats.hasOwnProperty(ev.make)) {
              makeStats[ev.make] = { totalMiles: 0, carCount: 0 };
          }
          makeStats[ev.make].totalMiles += ev.milesDriven;
          
          makeStats[ev.make].carCount++;
      });
      const averageMilesDriven = {};
       for (const make in makeStats) {
        const average = makeStats[make].totalMiles / makeStats[make].carCount;
        const roundedAverage = Math.round(average * 100) / 100;
        averageMilesDriven[make] = roundedAverage;
    }

    const makes = [];
    const averageMiles = [];
    for (const make in averageMilesDriven) {
      if (averageMilesDriven.hasOwnProperty(make)) {
          makes.push(make);
          averageMiles.push(averageMilesDriven[make]);
      }
  }

  return { makes, averageMiles };
}
    </script>
      </div>

      <div id="content-co-author" class="tabcontent">
        <h2>Global Average Miles driven per Types of vehicle 2023-2024</h2>
        <canvas id="Averagemilesdrivenpertypes" width="200" height="50"></canvas>
        <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
        
        <canvas id="Averagemilesdrivenpertypes" width="200" height="50"></canvas>
        <script>

      window.addEventListener('load', setup);

      async function setup() {
        const ctx = document.getElementById('Averagemilesdrivenpertypes').getContext('2d');
        const Averagemiles = await getData();
        const myChart = new Chart(ctx, {
          type: 'pie',
          data: {
            labels: Averagemiles.types,
            datasets: [
              {
                label: 'Miles driven in Miles',
                data: Averagemiles.averageMiles,
                fill: false,
                borderColor: 'rgba(255, 99, 132, 1)',
                backgroundColor: 'rgba(255, 99, 132, 0.5)',
                borderWidth: 1
              }
            ]
          },
          options: {}
        });
      }

      async function getData() {

        const api = await fetch(`/api/V1/all`);
        const api_data = await api.json();
        const array_data = api_data.result;
        const makeStats = {};
        array_data.forEach(ev => {
          if (!makeStats.hasOwnProperty(ev.type)) {
              makeStats[ev.type] = { totalMiles: 0, carCount: 0 };
          }
          makeStats[ev.type].totalMiles += ev.milesDriven;
          
          makeStats[ev.type].carCount++;
      });
      const averageMilesDriven = {};
       for (const type in makeStats) {
        const average = makeStats[type].totalMiles / makeStats[type].carCount;
        const roundedAverage = Math.round(average * 100) / 100;
        averageMilesDriven[type] = roundedAverage;
    }

    const types = [];
    const averageMiles = [];
    for (const type in averageMilesDriven) {
      if (averageMilesDriven.hasOwnProperty(type)) {
          types.push(type);
          averageMiles.push(averageMilesDriven[type]);
      }
  }

  return { types, averageMiles };
}
    </script>

      </div>

      <!-- wordcloud content-->

      <div id="content-wordcloud" class="tabcontent">
        <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
        <h2>Global Average Miles driven by the types of the companies 2023-2024</h2>
        <canvas id="Averagemilestypesmakes" width="200" height="50"></canvas>
        <script>
          // Data from: https://data.giss.nasa.gov/gistemp/
          // Mean from: https://earthobservatory.nasa.gov/world-of-change/DecadalTemp
    
          window.addEventListener('load', setup);
    
          async function setup() {
            const ctx = document.getElementById('Averagemilestypesmakes').getContext('2d');
            const Averagemiles = await gettypersmakersData();
            const myChart = new Chart(ctx, {
              type: 'bar',
              data: {
                labels: Averagemiles.types,
                datasets: [
                  {
                    label: 'Miles driven (in Miles)',
                    data: Averagemiles.averageMiles,
                    fill: false,
                    borderColor: 'rgba(255, 99, 132, 1)',
                    backgroundColor: 'rgba(255, 99, 132, 0.5)',
                    borderWidth: 1
                  }
                ]
              },
              options: {}
            });
          }
    
          async function gettypersmakersData() {
    
            const api = await fetch(`/api/V1/all`);
            const api_data = await api.json();
            const array_data = api_data.result;
            const makeStats = {};
            array_data.forEach(ev => {
              let labeldata = ev.make+ " - "+ev.type;
              if (!makeStats.hasOwnProperty()) {
                  makeStats[labeldata] = { totalMiles: 0, carCount: 0 };
              }
              makeStats[labeldata].totalMiles += ev.milesDriven;
              
              makeStats[labeldata].carCount++;
          });
          const averageMilesDriven = {};
           for (const type in makeStats) {
            const average = makeStats[type].totalMiles / makeStats[type].carCount;
            const roundedAverage = Math.round(average * 100) / 100;
            averageMilesDriven[type] = roundedAverage;
        }
        const types = [];
        const averageMiles = [];
        for (const type in averageMilesDriven) {
          if (averageMilesDriven.hasOwnProperty(type)) {
              types.push(type);
              averageMiles.push(averageMilesDriven[type]);
          }
      }
    
      return { types, averageMiles };
    }
        </script>
    
      </div>

    </section>

    <script src="browser-app.js"></script>
    <script src="script.js"></script>

    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"
      integrity="sha512-bZS47S7sPOxkjU/4Bt0zrhEtWx0y0CRkhEp8IckzK+ltifIIE9EMIMTuT/mEzoIMewUINruDBIR/jJnbguonqQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>

    <script src="https://requirejs.org/docs/release/2.3.5/minified/require.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>

    <script src="chord.js"></script>
    <script src="//www.amcharts.com/lib/4/core.js"></script>
    <script src="//www.amcharts.com/lib/4/charts.js"></script>
    <script src="//www.amcharts.com/lib/4/themes/animated.js"></script>
    
  </body>
</html>
